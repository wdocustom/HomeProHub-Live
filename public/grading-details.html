<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8" />
  <title>HomeProHub – Grading System Details</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    .hero {
      max-width: 900px;
      margin: 48px auto 24px;
      padding: 0 24px;
      text-align: center;
    }
    .hero-title {
      font-size: 28px;
      font-weight: 700;
      letter-spacing: -0.03em;
      margin-bottom: 10px;
      color: #111827;
    }
    .hero-subtitle {
      font-size: 14px;
      line-height: 1.6;
      color: #6b7280;
      max-width: 640px;
      margin: 0 auto;
    }
    .content-grid {
      max-width: 900px;
      margin: 0 auto 60px;
      padding: 0 24px;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }
    @media (max-width: 800px) {
      .content-grid {
        grid-template-columns: 1fr;
      }
    }
    .grade-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid #e5e7eb;
    }
    .grade-title {
      font-size: 20px;
      margin: 0;
    }
    .grade-pill {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 6px;
      background: #f0f4ff;
      color: #2563eb;
      font-weight: 600;
    }
    .criteria-list {
      list-style: none;
      padding: 0;
      margin: 10px 0 0;
      font-size: 14px;
      color: #4b5563;
    }
    .criteria-list li {
      margin-bottom: 10px;
      padding-left: 15px;
      position: relative;
    }
    .criteria-list li::before {
      content: "✓";
      color: #10b981;
      font-weight: 700;
      position: absolute;
      left: 0;
    }
  </style></head><body><header class="navbar">
  <div class="nav-inner">
    <div class="brand-area">
      <div class="brand-logo">H</div>
      <div class="brand-name">HomeProHub</div>
    </div>
    <div class="nav-links">
      <a href="index.html">Home</a>
      <div class="profile-area">
        <button class="logout-btn" onclick="logout()">Logout</button>
      </div>
    </div>
  </div>
</header><main>
  <section class="hero">
    <h1 class="hero-title">HomeProHub Grading System: Transparency in Vetting.</h1>
    <p class="hero-subtitle">
      Our grading system (A+ to F) is based on clear, weighted metrics, not just random reviews. Learn exactly how we score both contractors and homeowners.
    </p>
  </section>

  <section class="content-grid" id="gradingContent">
    <p style="grid-column: 1 / -1; text-align: center;">Loading grading criteria...</p>
  </section></main><script>
  // --- USER AUTH/NAV SCRIPT START ---
  function getUserData() {
    try {
      const raw = localStorage.getItem("homeprohub_user");
      return raw ? JSON.parse(raw) : null;
    } catch (e) {
      return null;
    }
  }

  const user = getUserData();
  const profileArea = document.querySelector('.profile-area'); 

  // Check if user is logged in and add the Profile/Name Link
  if (user && user.name) {
    const nameLink = document.createElement('a');
    nameLink.href = 'user-profile.html';
    nameLink.className = 'profile-link';
    // Use the stored first name for the link text
    nameLink.textContent = user.name.split(' ')[0]; 
    // This now works because profileArea exists in the HTML!
    profileArea.prepend(nameLink); 
  } else {
    // If not logged in, redirect them back to choose role
    window.location.href = "index.html";
  }

  function logout() {
    localStorage.removeItem("homeprohub_user");
    localStorage.removeItem("homeprohub_history_v1");
    window.location.href = "index.html";
  }
  // --- USER AUTH/NAV SCRIPT END ---


  async function loadGradingData() {
    const contentGrid = document.getElementById('gradingContent');
    contentGrid.innerHTML = ''; 

    try {
      // Fetch data from the secure server route
      const response = await fetch('http://localhost:3000/grading-data');
      if (!response.ok) {
          throw new Error(`Server status: ${response.status}`);
      }
      const data = await response.json();

      // --- CONTRACTOR CRITERIA CARD ---
      const contractorCard = document.createElement('div');
      contractorCard.className = 'card';
      contractorCard.innerHTML = `
        <div class="grade-header">
          <h2 class="grade-title">Contractor Grade Criteria</h2>
          <span class="grade-pill">Visible to Homeowners</span>
        </div>
        <p style="font-size: 14px; color: #4b5563;">
          ${data.contractor_grading_criteria.description}
        </p>
        <h3 style="font-size: 16px; margin: 15px 0 5px;">Key Data Points (Weight)</h3>
        <ul class="criteria-list">
          <li>State/City License Verification (Weight: 30%)</li>
          <li>Completed Projects (Volume and Diversity) (Weight: 20%)</li>
          <li>Completion on Time (Adherence to contract timelines) (Weight: 15%)</li>
          <li>Number of client complaints (past 2 years) (Weight: 15%)</li>
          <li>Average response time on platform (for communication score) (Weight: 10%)</li>
          <li>Clarity of scope language in uploaded bids (AI assessed) (Weight: 10%)</li>
          <li>Historical data on payment disputes (low score on financial risk) (Weight: 10%)</li>
        </ul>
      `;
      contentGrid.appendChild(contractorCard);

      // --- HOMEOWNER CRITERIA CARD ---
      const homeownerCard = document.createElement('div');
      homeownerCard.className = 'card';
      homeownerCard.innerHTML = `
        <div class="grade-header">
          <h2 class="grade-title">Homeowner Grade Criteria</h2>
          <span class="grade-pill" style="background:#fff3f2; color:#ef4444;">Visible to Contractors Only</span>
        </div>
        <p style="font-size: 14px; color: #4b5563;">
          ${data.homeowner_grading_criteria.description}
        </p>
        <h3 style="font-size: 16px; margin: 15px 0 5px;">Key Data Points (Weight)</h3>
        <ul class="criteria-list">
          ${data.homeowner_grading_criteria.data_points_required.map((point, index) => {
            const weights = data.homeowner_grading_criteria.grade_weighting;
            const keys = Object.keys(weights);
            let weightKey = keys[index % keys.length]; 
            return `<li>${point} (Weight: ${weights[weightKey]}%)</li>`;
          }).join('')}
        </ul>
      `;
      contentGrid.appendChild(homeownerCard);

    } catch (error) {
      console.error("Could not load grading logic:", error);
      contentGrid.innerHTML = `<div class="card" style="grid-column: 1 / -1; text-align: center; color: #ef4444;">
        Error loading grading logic: Could not connect to data source or data is invalid. (Check your server.js console for errors or confirm the JSON file is present).
      </div>`;
    }
  }

  document.addEventListener('DOMContentLoaded', loadGradingData);
</script></body></html>