<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pricing Plans â€“ HomeProHub</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="components/navigation.css">
  <!-- Supabase Auth -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="/services/auth.js"></script>
  <style>
    .pricing-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 60px 24px;
    }

    .pricing-header {
      text-align: center;
      margin-bottom: 60px;
    }

    .pricing-header h1 {
      font-size: 48px;
      margin: 0 0 16px 0;
      background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .pricing-header p {
      font-size: 20px;
      color: #6b7280;
      max-width: 600px;
      margin: 0 auto;
    }

    .role-toggle {
      display: flex;
      justify-content: center;
      gap: 16px;
      margin: 40px 0;
    }

    .role-toggle button {
      padding: 12px 32px;
      font-size: 16px;
      font-weight: 600;
      border: 2px solid #e5e7eb;
      background: white;
      color: #6b7280;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .role-toggle button.active {
      background: #2563eb;
      color: white;
      border-color: #2563eb;
    }

    .role-toggle button:hover:not(.active) {
      border-color: #2563eb;
      color: #2563eb;
    }

    .pricing-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 32px;
      margin-bottom: 60px;
    }

    .pricing-card {
      background: white;
      border: 2px solid #e5e7eb;
      border-radius: 16px;
      padding: 32px;
      position: relative;
      transition: all 0.3s;
    }

    .pricing-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    }

    .pricing-card.featured {
      border-color: #2563eb;
      background: linear-gradient(135deg, #eff6ff 0%, #f5f3ff 100%);
    }

    .pricing-card.featured::before {
      content: 'MOST POPULAR';
      position: absolute;
      top: -12px;
      left: 50%;
      transform: translateX(-50%);
      background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%);
      color: white;
      padding: 4px 16px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 700;
      letter-spacing: 0.5px;
    }

    .tier-name {
      font-size: 28px;
      font-weight: 700;
      margin: 0 0 8px 0;
      color: #111827;
    }

    .tier-description {
      font-size: 14px;
      color: #6b7280;
      margin: 0 0 24px 0;
    }

    .tier-price {
      display: flex;
      align-items: baseline;
      gap: 4px;
      margin-bottom: 8px;
    }

    .price-amount {
      font-size: 48px;
      font-weight: 800;
      color: #111827;
    }

    .price-currency {
      font-size: 24px;
      font-weight: 600;
      color: #6b7280;
    }

    .price-period {
      font-size: 16px;
      color: #9ca3af;
    }

    .roi-text {
      background: #fef3c7;
      color: #92400e;
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 600;
      margin: 16px 0;
      text-align: center;
    }

    .tier-cta {
      width: 100%;
      padding: 14px 24px;
      font-size: 16px;
      font-weight: 600;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      margin: 24px 0;
      border: none;
    }

    .tier-cta.primary {
      background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%);
      color: white;
    }

    .tier-cta.primary:hover {
      transform: scale(1.02);
      box-shadow: 0 8px 16px rgba(37,99,235,0.3);
    }

    .tier-cta.secondary {
      background: white;
      color: #2563eb;
      border: 2px solid #2563eb;
    }

    .tier-cta.secondary:hover {
      background: #eff6ff;
    }

    .features-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .features-list li {
      padding: 12px 0;
      display: flex;
      align-items: flex-start;
      gap: 12px;
      font-size: 15px;
      color: #374151;
      border-bottom: 1px solid #f3f4f6;
    }

    .features-list li:last-child {
      border-bottom: none;
    }

    .feature-icon {
      flex-shrink: 0;
      width: 20px;
      height: 20px;
      background: #10b981;
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 700;
    }

    .pay-per-lead-section {
      background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
      border-radius: 16px;
      padding: 48px;
      text-align: center;
      margin: 60px 0;
    }

    .pay-per-lead-section h2 {
      font-size: 36px;
      margin: 0 0 16px 0;
      color: #111827;
    }

    .pay-per-lead-section p {
      font-size: 18px;
      color: #6b7280;
      margin: 0 0 32px 0;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .ppl-features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 24px;
      max-width: 800px;
      margin: 0 auto;
    }

    .ppl-feature {
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    .ppl-feature-icon {
      font-size: 32px;
      margin-bottom: 12px;
    }

    .ppl-feature h3 {
      font-size: 18px;
      margin: 0 0 8px 0;
      color: #111827;
    }

    .ppl-feature p {
      font-size: 14px;
      color: #6b7280;
      margin: 0;
    }

    .comparison-note {
      text-align: center;
      padding: 32px;
      background: #eff6ff;
      border-radius: 12px;
      margin: 40px 0;
    }

    .comparison-note h3 {
      font-size: 24px;
      margin: 0 0 12px 0;
      color: #1e40af;
    }

    .comparison-note p {
      font-size: 16px;
      color: #1e3a8a;
      margin: 0;
    }

    .faq-section {
      max-width: 800px;
      margin: 60px auto 0;
    }

    .faq-section h2 {
      font-size: 36px;
      text-align: center;
      margin: 0 0 40px 0;
    }

    .faq-item {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 16px;
    }

    .faq-question {
      font-size: 18px;
      font-weight: 600;
      color: #111827;
      margin: 0 0 12px 0;
    }

    .faq-answer {
      font-size: 15px;
      color: #6b7280;
      line-height: 1.6;
      margin: 0;
    }

    @media (max-width: 768px) {
      .pricing-header h1 {
        font-size: 36px;
      }

      .pricing-grid {
        grid-template-columns: 1fr;
      }

      .pay-per-lead-section {
        padding: 32px 24px;
      }

      .ppl-features {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Navigation component will be injected here by navigation.js -->

  <div class="pricing-container">
    <div class="pricing-header">
      <h1>Choose Your Plan</h1>
      <p>Whether you're a homeowner or contractor, we have the perfect plan to match your needs</p>
    </div>

    <div class="role-toggle">
      <button id="homeownerToggle" class="active" onclick="showPricing('homeowner')">For Homeowners</button>
      <button id="contractorToggle" onclick="showPricing('contractor')">For Contractors</button>
    </div>

    <!-- Homeowner Pricing -->
    <div id="homeownerPricing">
      <div class="pricing-grid">
        <!-- Starter -->
        <div class="pricing-card">
          <h2 class="tier-name">Starter</h2>
          <p class="tier-description">Perfect for DIY homeowners</p>
          <div class="tier-price">
            <span class="price-currency">$</span>
            <span class="price-amount">0</span>
            <span class="price-period">/month</span>
          </div>
          <button class="tier-cta secondary" onclick="selectPlan('homeowner_starter')">Get Started Free</button>
          <ul class="features-list">
            <li><span class="feature-icon">âœ“</span> Basic AI diagnosis</li>
            <li><span class="feature-icon">âœ“</span> Convert diagnosis to Job Post</li>
            <li><span class="feature-icon">âœ“</span> Contractor Directory access</li>
            <li><span class="feature-icon">âœ“</span> Unlimited job posting</li>
          </ul>
        </div>

        <!-- Pro -->
        <div class="pricing-card featured">
          <h2 class="tier-name">Pro</h2>
          <p class="tier-description">For active homeowners managing projects</p>
          <div class="tier-price">
            <span class="price-currency">$</span>
            <span class="price-amount">50</span>
            <span class="price-period">/month</span>
          </div>
          <button class="tier-cta primary" onclick="selectPlan('homeowner_pro')">Upgrade to Pro</button>
          <ul class="features-list">
            <li><span class="feature-icon">âœ“</span> Everything in Starter</li>
            <li><span class="feature-icon">âœ“</span> Text an Expert (SMS)</li>
            <li><span class="feature-icon">âœ“</span> 2 phone consultations/month</li>
            <li><span class="feature-icon">âœ“</span> 1 video call (60 mins/month)</li>
          </ul>
        </div>

        <!-- Elite -->
        <div class="pricing-card">
          <h2 class="tier-name">Elite</h2>
          <p class="tier-description">Full concierge service</p>
          <div class="tier-price">
            <span class="price-currency">$</span>
            <span class="price-amount">99</span>
            <span class="price-period">/month</span>
          </div>
          <div class="roi-text">Optional human Owners Rep available</div>
          <button class="tier-cta secondary" onclick="selectPlan('homeowner_elite')">Go Elite</button>
          <ul class="features-list">
            <li><span class="feature-icon">âœ“</span> Everything in Pro</li>
            <li><span class="feature-icon">âœ“</span> Full AI Owners Rep features</li>
            <li><span class="feature-icon">âœ“</span> Unlimited consultations</li>
            <li><span class="feature-icon">âœ“</span> Priority contractor matching</li>
            <li><span class="feature-icon">âœ“</span> Optional human Owners Rep (add-on)</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Contractor Pricing -->
    <div id="contractorPricing" style="display: none;">
      <div class="pricing-grid">
        <!-- Starter -->
        <div class="pricing-card">
          <h2 class="tier-name">Starter</h2>
          <p class="tier-description">Try HomeProHub risk-free</p>
          <div class="tier-price">
            <span class="price-currency">$</span>
            <span class="price-amount">0</span>
            <span class="price-period">/month</span>
          </div>
          <button class="tier-cta secondary" onclick="selectPlan('contractor_starter')">Get Started Free</button>
          <ul class="features-list">
            <li><span class="feature-icon">âœ“</span> View all job postings</li>
            <li><span class="feature-icon">âœ“</span> 2 bids per month</li>
            <li><span class="feature-icon">âœ“</span> Standard directory listing</li>
            <li><span class="feature-icon">âœ“</span> Basic profile</li>
          </ul>
        </div>

        <!-- Pro -->
        <div class="pricing-card featured">
          <h2 class="tier-name">Pro</h2>
          <p class="tier-description">For active contractors</p>
          <div class="tier-price">
            <span class="price-currency">$</span>
            <span class="price-amount">49</span>
            <span class="price-period">/month</span>
          </div>
          <div class="roi-text">ðŸ“Š Avg Pro wins 3 jobs/mo</div>
          <button class="tier-cta primary" onclick="selectPlan('contractor_pro')">Upgrade to Pro</button>
          <ul class="features-list">
            <li><span class="feature-icon">âœ“</span> Everything in Starter</li>
            <li><span class="feature-icon">âœ“</span> Unlimited bids</li>
            <li><span class="feature-icon">âœ“</span> Featured badge</li>
            <li><span class="feature-icon">âœ“</span> AI Estimate tool access</li>
            <li><span class="feature-icon">âœ“</span> Response time badge</li>
            <li><span class="feature-icon">âœ“</span> Priority support</li>
          </ul>
        </div>

        <!-- Premium -->
        <div class="pricing-card">
          <h2 class="tier-name">Premium</h2>
          <p class="tier-description">Maximum visibility and tools</p>
          <div class="tier-price">
            <span class="price-currency">$</span>
            <span class="price-amount">149</span>
            <span class="price-period">/month</span>
          </div>
          <div class="roi-text">ðŸš€ Avg Premium wins 8 jobs/mo</div>
          <button class="tier-cta secondary" onclick="selectPlan('contractor_premium')">Go Premium</button>
          <ul class="features-list">
            <li><span class="feature-icon">âœ“</span> Everything in Pro</li>
            <li><span class="feature-icon">âœ“</span> Top of search results</li>
            <li><span class="feature-icon">âœ“</span> Priority messaging</li>
            <li><span class="feature-icon">âœ“</span> Owners advocate referrals</li>
            <li><span class="feature-icon">âœ“</span> PM tools & templates</li>
            <li><span class="feature-icon">âœ“</span> Lead analytics</li>
            <li><span class="feature-icon">âœ“</span> Dedicated account manager</li>
          </ul>
        </div>
      </div>

      <!-- Pay-Per-Lead Section -->
      <div class="pay-per-lead-section">
        <h2>ðŸ’¡ Pay-Per-Lead Alternative</h2>
        <p>Not ready for a monthly subscription? Try our flexible pay-as-you-go option!</p>
        <div class="ppl-features">
          <div class="ppl-feature">
            <div class="ppl-feature-icon">ðŸ’µ</div>
            <h3>$15-30 per lead</h3>
            <p>Only pay when homeowners view your bid</p>
          </div>
          <div class="ppl-feature">
            <div class="ppl-feature-icon">ðŸŽ¯</div>
            <h3>No commitment</h3>
            <p>Cancel anytime, no monthly fees</p>
          </div>
          <div class="ppl-feature">
            <div class="ppl-feature-icon">ðŸ“ˆ</div>
            <h3>Smart upsell</h3>
            <p>Save money after 10 leads with Pro plan</p>
          </div>
        </div>
        <button class="tier-cta primary" style="max-width: 300px; margin: 32px auto 0;" onclick="selectPlan('contractor_ppl')">Try Pay-Per-Lead</button>
      </div>

      <div class="comparison-note">
        <h3>ðŸ’¡ Pro Tip</h3>
        <p>Most contractors save money switching to Pro after just 3 leads. Premium pays for itself with 5 jobs/month!</p>
      </div>
    </div>

    <!-- FAQ Section -->
    <div class="faq-section">
      <h2>Frequently Asked Questions</h2>

      <div class="faq-item">
        <h3 class="faq-question">Can I change plans at any time?</h3>
        <p class="faq-answer">Yes! You can upgrade, downgrade, or cancel your plan at any time. Changes take effect immediately, and we'll prorate any charges.</p>
      </div>

      <div class="faq-item">
        <h3 class="faq-question">How does pay-per-lead work for contractors?</h3>
        <p class="faq-answer">You only pay $15-30 when a homeowner views your bid. No monthly fees, no commitment. After 10 leads, we'll suggest our Pro plan to save you money.</p>
      </div>

      <div class="faq-item">
        <h3 class="faq-question">What payment methods do you accept?</h3>
        <p class="faq-answer">We accept all major credit cards (Visa, Mastercard, American Express, Discover) through our secure Stripe integration.</p>
      </div>

      <div class="faq-item">
        <h3 class="faq-question">Is there a free trial?</h3>
        <p class="faq-answer">All users start with our free Starter plan. You can explore the platform and upgrade when you're ready to unlock premium features!</p>
      </div>

      <div class="faq-item">
        <h3 class="faq-question">What happens if I hit my bid limit?</h3>
        <p class="faq-answer">Free Starter contractors can submit 2 bids/month. When you hit your limit, you'll be prompted to upgrade to Pro for unlimited bids or try pay-per-lead.</p>
      </div>
    </div>
  </div>

  <script>
    function showPricing(role) {
      // Update toggle buttons
      document.getElementById('homeownerToggle').classList.toggle('active', role === 'homeowner');
      document.getElementById('contractorToggle').classList.toggle('active', role === 'contractor');

      // Show/hide pricing sections
      document.getElementById('homeownerPricing').style.display = role === 'homeowner' ? 'block' : 'none';
      document.getElementById('contractorPricing').style.display = role === 'contractor' ? 'block' : 'none';
    }

    async function selectPlan(tierName) {
      console.log('Selected plan:', tierName);

      // Check if user is authenticated
      try {
        if (!window.authService || !window.authService.initialized) {
          await new Promise(resolve => {
            const checkInterval = setInterval(() => {
              if (window.authService && window.authService.initialized) {
                clearInterval(checkInterval);
                resolve();
              }
            }, 100);
          });
        }

        const user = await window.authService.getCurrentUser();

        if (!user) {
          // Not authenticated - redirect to login
          if (confirm('Please sign in to select a plan. Would you like to create an account or sign in now?')) {
            sessionStorage.setItem('selectedPlan', tierName);
            window.location.href = 'index.html';
          }
          return;
        }

        // User is authenticated - proceed with plan selection
        if (tierName.includes('starter') || tierName.includes('_ppl')) {
          // Free tier or pay-per-lead - just update their profile
          alert('Great choice! We\'ll update your plan.');

          // TODO: Call API to update subscription
          // For now, just show confirmation
          const planNames = {
            'homeowner_starter': 'Homeowner Starter',
            'contractor_starter': 'Contractor Starter',
            'contractor_ppl': 'Pay-Per-Lead'
          };

          alert(`You're now on the ${planNames[tierName] || tierName} plan!`);

        } else {
          // Paid tier - redirect to Stripe checkout
          alert('Redirecting to secure checkout...\n\n(Stripe integration coming soon)');

          // TODO: Implement Stripe checkout
          // const response = await window.authService.authenticatedFetch('/api/subscriptions/create-checkout', {
          //   method: 'POST',
          //   body: JSON.stringify({ tierName })
          // });
          // const { checkoutUrl } = await response.json();
          // window.location.href = checkoutUrl;
        }

      } catch (error) {
        console.error('Error selecting plan:', error);
        alert('Something went wrong. Please try again.');
      }
    }

    // Check for selectedPlan in sessionStorage (from redirect)
    window.addEventListener('DOMContentLoaded', () => {
      const selectedPlan = sessionStorage.getItem('selectedPlan');
      if (selectedPlan) {
        sessionStorage.removeItem('selectedPlan');
        // Auto-select the plan if user just logged in
        setTimeout(() => selectPlan(selectedPlan), 1000);
      }
    });
  </script>

  <!-- Unified Navigation Component -->
  <script src="components/navigation.js"></script>
</body>
</html>
