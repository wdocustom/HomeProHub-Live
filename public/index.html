<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HomeProHub ‚Äì Understand Your Home Issues, Connect with Verified Contractors</title>
  <meta name="description" content="Free AI-powered home issue guidance. Connect with vetted, licensed contractors. Optional on-demand expert access. Trust, clarity, no hidden fees.">

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Supabase Auth -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="/services/auth.js"></script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
    }

    body {
      line-height: 1.6;
      color: #1f2937;
      background: #f8fafc;
    }

    /* SECTION A: TOP NAV */
    .top-nav {
      background: #ffffff;
      border-bottom: 1px solid #e5e7eb;
      padding: 16px 0;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .nav-container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .logo {
      font-size: 22px;
      font-weight: 700;
      color: #1f2937;
      text-decoration: none;
      letter-spacing: -0.02em;
    }

    .nav-links {
      display: flex;
      gap: 32px;
      align-items: center;
    }

    .nav-links a {
      color: #6b7280;
      text-decoration: none;
      font-size: 15px;
      font-weight: 500;
      transition: color 0.2s;
    }

    .nav-links a:hover {
      color: #1f2937;
    }

    .nav-cta {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .btn-secondary {
      padding: 8px 16px;
      background: transparent;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      color: #374151;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-secondary:hover {
      background: #f9fafb;
    }

    .btn-primary {
      padding: 10px 20px;
      background: #3b82f6;
      border: none;
      border-radius: 6px;
      color: white;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-primary:hover {
      background: #2563eb;
    }

    /* SECTION B: HERO (Homeowner-first sandbox) */
    .hero {
      max-width: 900px;
      margin: 80px auto 120px;
      padding: 0 24px;
      text-align: center;
    }

    .hero h1 {
      font-size: 52px;
      font-weight: 700;
      color: #111827;
      letter-spacing: -0.03em;
      line-height: 1.1;
      margin-bottom: 24px;
    }

    .hero-subhead {
      font-size: 20px;
      color: #6b7280;
      line-height: 1.6;
      margin-bottom: 16px;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }

    .hero-helper {
      font-size: 15px;
      color: #9ca3af;
      font-style: italic;
      margin-bottom: 40px;
    }

    .hero-actions {
      display: flex;
      flex-direction: column;
      gap: 16px;
      align-items: center;
      margin-bottom: 32px;
      width: 100%;
      max-width: 100%;
    }

    .hero-input-group {
      display: flex;
      gap: 12px;
      width: 100%;
      max-width: 600px;
    }

    .hero-input {
      flex: 1;
      padding: 16px 20px;
      border: 2px solid #d1d5db;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.2s;
    }

    .hero-input:focus {
      outline: none;
      border-color: #3b82f6;
    }

    .btn-large {
      padding: 16px 32px;
      background: #3b82f6;
      border: none;
      border-radius: 8px;
      color: white;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
    }

    .btn-large:hover {
      background: #2563eb;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }

    .hero-secondary-link {
      color: #6b7280;
      font-size: 15px;
      text-decoration: underline;
      cursor: pointer;
    }

    .hero-trust-line {
      font-size: 13px;
      color: #9ca3af;
      margin-top: 24px;
    }

    /* Smart Composer Styles */
    .photo-preview-container {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
      overflow-x: auto;
      padding: 8px 8px 12px;
      scroll-snap-type: x mandatory;
      scrollbar-width: thin;
      width: 100%;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }

    .photo-preview-container::-webkit-scrollbar {
      height: 6px;
    }

    .photo-preview-container::-webkit-scrollbar-track {
      background: #f1f5f9;
      border-radius: 3px;
    }

    .photo-preview-container::-webkit-scrollbar-thumb {
      background: #cbd5e1;
      border-radius: 3px;
    }

    .photo-preview-item {
      position: relative;
      flex-shrink: 0;
      scroll-snap-align: start;
    }

    .photo-preview-item img {
      height: 80px;
      width: 80px;
      object-fit: cover;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      border: 2px solid white;
    }

    .photo-remove-btn {
      position: absolute;
      top: -8px;
      right: -8px;
      background: #ef4444;
      color: white;
      border: none;
      border-radius: 50%;
      padding: 4px;
      width: 24px;
      height: 24px;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .photo-remove-btn:hover {
      background: #dc2626;
      transform: scale(1.1);
    }

    .smart-composer {
      position: relative;
      display: flex;
      align-items: center;
      background: white;
      border-radius: 9999px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.08), 0 0 1px rgba(15,23,42,0.05);
      padding: 8px;
      transition: all 0.3s;
      max-width: 700px;
      width: 100%;
      margin: 0 auto;
    }

    .smart-composer:focus-within {
      box-shadow: 0 20px 60px rgba(59,130,246,0.15), 0 0 0 2px #3b82f6;
    }

    .smart-composer input[type="text"] {
      flex: 1;
      border: none;
      background: transparent;
      padding: 16px 24px;
      font-size: 16px;
      color: #1e293b;
      outline: none;
    }

    .smart-composer input[type="text"]::placeholder {
      color: #94a3b8;
    }

    .composer-divider {
      height: 32px;
      width: 1px;
      background: #e2e8f0;
      margin: 0 8px;
    }

    .composer-photo-btn {
      padding: 12px;
      color: #64748b;
      background: transparent;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .composer-photo-btn:hover {
      color: #3b82f6;
      background: #eff6ff;
    }

    .composer-photo-btn svg {
      width: 24px;
      height: 24px;
    }

    .composer-submit-btn {
      margin-left: 8px;
      padding: 12px 24px;
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
      color: white;
      border: none;
      border-radius: 9999px;
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 12px rgba(59,130,246,0.3);
      display: flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
    }

    .composer-submit-btn:hover {
      background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
      transform: translateY(-1px) scale(1.02);
      box-shadow: 0 6px 20px rgba(59,130,246,0.4);
    }

    .composer-submit-btn:active {
      transform: translateY(0) scale(0.98);
    }

    .composer-submit-btn svg {
      width: 16px;
      height: 16px;
    }

    .hidden {
      display: none;
    }

    @media (max-width: 640px) {
      .smart-composer {
        padding: 6px;
      }

      .smart-composer input[type="text"] {
        padding: 12px 16px;
        font-size: 15px;
      }

      .composer-submit-btn {
        padding: 12px 20px;
        font-size: 14px;
      }

      .photo-preview-item img {
        height: 64px;
        width: 64px;
      }
    }

    /* Loading Overlay */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .loading-content {
      background: white;
      padding: 48px 64px;
      border-radius: 16px;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    .loading-spinner {
      width: 56px;
      height: 56px;
      border: 5px solid #e5e7eb;
      border-top-color: #3b82f6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 24px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .loading-text {
      font-size: 20px;
      font-weight: 600;
      color: #111827;
      margin-bottom: 8px;
    }

    .loading-subtext {
      font-size: 14px;
      color: #6b7280;
    }

    /* AI Results Section */
    .ai-results-section {
      background: #f9fafb;
      padding: 80px 24px;
    }

    .results-container {
      max-width: 900px;
      margin: 0 auto;
    }

    .result-card {
      background: white;
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      margin-bottom: 24px;
    }

    .result-header {
      margin-bottom: 32px;
      padding-bottom: 24px;
      border-bottom: 2px solid #e5e7eb;
    }

    .result-title {
      font-size: 32px;
      font-weight: 700;
      color: #111827;
      margin-bottom: 16px;
    }

    .confidence-badge {
      display: inline-block;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
      text-transform: uppercase;
    }

    .confidence-high {
      background: #d1fae5;
      color: #065f46;
    }

    .confidence-medium {
      background: #fef3c7;
      color: #92400e;
    }

    .confidence-low {
      background: #fee2e2;
      color: #991b1b;
    }

    .diy-badge {
      display: inline-block;
      padding: 8px 16px;
      border-radius: 8px;
      font-weight: 600;
      margin-left: 12px;
    }

    .diy-safe {
      background: #d1fae5;
      color: #065f46;
    }

    .diy-inspection {
      background: #dbeafe;
      color: #1e40af;
    }

    .diy-pro {
      background: #fef3c7;
      color: #92400e;
    }

    .diy-urgent {
      background: #fee2e2;
      color: #991b1b;
    }

    .result-summary {
      font-size: 18px;
      line-height: 1.7;
      color: #374151;
      margin-bottom: 32px;
    }

    .result-section {
      margin-bottom: 32px;
    }

    .result-section-title {
      font-size: 20px;
      font-weight: 700;
      color: #111827;
      margin-bottom: 16px;
    }

    .cause-card {
      background: #f9fafb;
      border-left: 4px solid #3b82f6;
      padding: 16px 20px;
      margin-bottom: 12px;
      border-radius: 8px;
    }

    .cause-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 8px;
    }

    .cause-label {
      font-weight: 600;
      font-size: 16px;
      color: #111827;
    }

    .likelihood-badge {
      padding: 3px 10px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
    }

    .likelihood-most_likely {
      background: #d1fae5;
      color: #065f46;
    }

    .likelihood-possible {
      background: #fef3c7;
      color: #92400e;
    }

    .likelihood-less_likely {
      background: #f3f4f6;
      color: #6b7280;
    }

    .cause-why {
      font-size: 14px;
      color: #6b7280;
      line-height: 1.5;
    }

    .action-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .action-list li {
      padding: 12px 16px;
      background: #f0fdf4;
      border-radius: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: start;
      gap: 12px;
    }

    .action-list li::before {
      content: '‚úì';
      font-size: 18px;
      color: #10b981;
      font-weight: 700;
      flex-shrink: 0;
    }

    .dont-list li {
      background: #fef2f2;
    }

    .dont-list li::before {
      content: '‚úó';
      color: #ef4444;
    }

    .trade-card {
      background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
      border: 2px solid #3b82f6;
      border-radius: 12px;
      padding: 20px;
    }

    .trade-name {
      font-size: 18px;
      font-weight: 700;
      color: #1e40af;
      margin-bottom: 8px;
      text-transform: capitalize;
    }

    .trade-why {
      font-size: 14px;
      color: #1e3a8a;
    }

    .cost-card {
      background: #f0fdf4;
      border: 2px solid #10b981;
      border-radius: 12px;
      padding: 20px;
    }

    .cost-tier {
      font-size: 24px;
      font-weight: 700;
      color: #065f46;
      margin-bottom: 12px;
    }

    .cost-drivers {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .cost-drivers li {
      font-size: 14px;
      color: #047857;
      padding: 6px 0;
      padding-left: 20px;
      position: relative;
    }

    .cost-drivers li::before {
      content: '‚Ä¢';
      position: absolute;
      left: 0;
      font-weight: 700;
    }

    .pro-message-box {
      background: #f9fafb;
      border: 2px solid #d1d5db;
      border-radius: 12px;
      padding: 20px;
      position: relative;
    }

    .pro-message-text {
      font-size: 15px;
      line-height: 1.7;
      color: #374151;
      margin-bottom: 12px;
    }

    .copy-btn {
      padding: 8px 16px;
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .copy-btn:hover {
      background: #2563eb;
    }

    .cta-section {
      display: flex;
      gap: 16px;
      margin-top: 32px;
      padding-top: 32px;
      border-top: 2px solid #e5e7eb;
    }

    .cta-primary {
      flex: 1;
      padding: 16px 32px;
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
    }

    .cta-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(59,130,246,0.4);
    }

    .cta-secondary {
      padding: 16px 32px;
      background: white;
      color: #3b82f6;
      border: 2px solid #3b82f6;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .cta-secondary:hover {
      background: #eff6ff;
    }

    .safety-flags {
      background: #fef2f2;
      border-left: 4px solid #ef4444;
      padding: 16px 20px;
      border-radius: 8px;
      margin-bottom: 24px;
    }

    .safety-flags-title {
      font-weight: 700;
      color: #991b1b;
      margin-bottom: 8px;
    }

    .safety-flags ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .safety-flags li {
      color: #991b1b;
      font-size: 14px;
      padding: 4px 0;
      padding-left: 20px;
      position: relative;
    }

    .safety-flags li::before {
      content: '‚ö†';
      position: absolute;
      left: 0;
    }

    .start-over-btn {
      display: block;
      margin: 24px auto 0;
      padding: 12px 24px;
      background: transparent;
      border: 2px solid #d1d5db;
      border-radius: 8px;
      color: #6b7280;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .start-over-btn:hover {
      border-color: #3b82f6;
      color: #3b82f6;
    }

    /* SECTION C: HOW IT WORKS */
    .how-it-works {
      background: #f9fafb;
      padding: 80px 24px;
    }

    .section-container {
      max-width: 1100px;
      margin: 0 auto;
    }

    .section-title {
      font-size: 36px;
      font-weight: 700;
      color: #111827;
      text-align: center;
      margin-bottom: 56px;
      letter-spacing: -0.02em;
    }

    .steps-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 48px;
    }

    .step-card {
      text-align: center;
    }

    .step-number {
      display: inline-block;
      width: 48px;
      height: 48px;
      background: #3b82f6;
      color: white;
      border-radius: 50%;
      font-size: 20px;
      font-weight: 700;
      line-height: 48px;
      margin-bottom: 20px;
    }

    .step-title {
      font-size: 20px;
      font-weight: 600;
      color: #111827;
      margin-bottom: 12px;
    }

    .step-description {
      font-size: 15px;
      color: #6b7280;
      line-height: 1.6;
    }

    /* SECTION D: THREE-PATH EXPLAINER */
    .three-paths {
      padding: 80px 24px;
    }

    .paths-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 32px;
      margin-top: 48px;
    }

    .path-card {
      background: white;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      padding: 32px;
      transition: all 0.2s;
    }

    .path-card:hover {
      border-color: #d1d5db;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .path-icon {
      font-size: 40px;
      margin-bottom: 16px;
      display: block;
    }

    .path-title {
      font-size: 22px;
      font-weight: 700;
      color: #111827;
      margin-bottom: 12px;
    }

    .path-subtitle {
      font-size: 15px;
      color: #6b7280;
      margin-bottom: 20px;
      line-height: 1.5;
    }

    .path-features {
      margin: 20px 0;
    }

    .path-feature {
      display: flex;
      align-items: start;
      gap: 8px;
      margin-bottom: 10px;
      font-size: 14px;
      color: #374151;
    }

    .path-card .btn-primary {
      width: 100%;
      margin-top: 20px;
    }

    .path-note {
      margin-top: 12px;
      font-size: 13px;
      color: #9ca3af;
      font-style: italic;
      text-align: center;
    }

    .path-card.no-button .btn-primary {
      display: none;
    }

    /* SECTION E: FAQ */
    .faq {
      padding: 80px 24px;
    }

    .faq-container {
      max-width: 800px;
      margin: 0 auto;
    }

    .faq-item {
      border-bottom: 1px solid #e5e7eb;
      padding: 24px 0;
    }

    .faq-question {
      font-size: 18px;
      font-weight: 600;
      color: #111827;
      margin-bottom: 12px;
    }

    .faq-answer {
      font-size: 15px;
      color: #6b7280;
      line-height: 1.7;
    }

    /* SECTION H: FOOTER */
    .footer {
      background: #1f2937;
      color: #9ca3af;
      padding: 48px 24px 32px;
    }

    .footer-container {
      max-width: 1100px;
      margin: 0 auto;
    }

    .footer-grid {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr 1fr;
      gap: 48px;
      margin-bottom: 40px;
    }

    .footer-brand {
      color: white;
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 16px;
    }

    .footer-disclaimer {
      font-size: 13px;
      line-height: 1.6;
      margin-bottom: 16px;
    }

    .footer-section-title {
      color: white;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 16px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .footer-links {
      list-style: none;
    }

    .footer-links li {
      margin-bottom: 12px;
    }

    .footer-links a {
      color: #9ca3af;
      text-decoration: none;
      font-size: 14px;
      transition: color 0.2s;
    }

    .footer-links a:hover {
      color: white;
    }

    .footer-bottom {
      border-top: 1px solid #374151;
      padding-top: 24px;
      text-align: center;
      font-size: 13px;
    }

    /* MOBILE RESPONSIVE */
    @media (max-width: 768px) {
      .nav-links {
        display: none;
      }

      .hero h1 {
        font-size: 36px;
      }

      .hero-subhead {
        font-size: 18px;
      }

      .hero-input-group {
        flex-direction: column;
      }

      .steps-grid,
      .paths-grid,
      .footer-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Role Selection Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: white;
      border-radius: 12px;
      padding: 40px;
      max-width: 500px;
      width: 90%;
    }

    .modal-title {
      font-size: 24px;
      font-weight: 700;
      color: #111827;
      margin-bottom: 24px;
      text-align: center;
    }

    .role-options {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .role-option {
      padding: 20px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .role-option:hover {
      border-color: #3b82f6;
      background: #eff6ff;
    }

    .role-option-title {
      font-size: 18px;
      font-weight: 600;
      color: #111827;
      margin-bottom: 8px;
    }

    .role-option-description {
      font-size: 14px;
      color: #6b7280;
    }

    .modal-close {
      text-align: center;
      margin-top: 24px;
    }

    .modal-close button {
      background: transparent;
      border: none;
      color: #6b7280;
      cursor: pointer;
      font-size: 14px;
    }

    /* Toast Notification */
    .toast {
      position: fixed;
      top: 24px;
      right: 24px;
      background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
      border: 2px solid #10b981;
      border-radius: 12px;
      padding: 20px 24px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
      z-index: 10000;
      min-width: 320px;
      max-width: 420px;
      transform: translateX(500px);
      opacity: 0;
      transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    .toast.show {
      transform: translateX(0);
      opacity: 1;
    }

    .toast-content {
      display: flex;
      align-items: flex-start;
      gap: 12px;
    }

    .toast-icon {
      font-size: 28px;
      flex-shrink: 0;
    }

    .toast-text {
      flex: 1;
    }

    .toast-title {
      font-weight: 700;
      color: #065f46;
      margin-bottom: 4px;
      font-size: 16px;
    }

    .toast-message {
      color: #047857;
      font-size: 14px;
      line-height: 1.5;
    }

    .toast-close {
      background: none;
      border: none;
      color: #047857;
      cursor: pointer;
      font-size: 20px;
      padding: 0;
      width: 24px;
      height: 24px;
      flex-shrink: 0;
      opacity: 0.7;
      transition: opacity 0.2s;
    }

    .toast-close:hover {
      opacity: 1;
    }

    @media (max-width: 768px) {
      .toast {
        top: 16px;
        right: 16px;
        left: 16px;
        min-width: auto;
        max-width: none;
      }
    }
  </style>
</head>
<body>

  <!-- Toast Notification (for account deletion goodbye message) -->
  <div id="accountDeletedToast" class="toast">
    <div class="toast-content">
      <span class="toast-icon">üëã</span>
      <div class="toast-text">
        <div class="toast-title">Account Deleted Successfully</div>
        <div class="toast-message">Your account has been permanently deleted. We're sorry to see you go!</div>
      </div>
      <button class="toast-close" onclick="closeToast()" aria-label="Close">√ó</button>
    </div>
  </div>

  <!-- SECTION A: TOP NAV -->
  <nav class="top-nav">
    <div class="nav-container">
      <a href="/" class="logo">HomeProHub</a>

      <div class="nav-links">
        <a href="#homeowners">Homeowners</a>
        <a href="/contractors.html">Contractors</a>
        <a href="#how-it-works">How it Works</a>
        <a href="#faq">FAQ</a>
      </div>

      <div class="nav-cta">
        <button class="btn-secondary" onclick="showSignIn()">Sign in</button>
        <button class="btn-primary" onclick="showRoleSelection()">Get started</button>
      </div>
    </div>
  </nav>

  <!-- SECTION B: HERO WRAPPER (Sanctuary Glass) -->
  <div class="relative bg-gradient-to-b from-blue-50/50 to-slate-50 pt-20 pb-16 px-4 sm:px-6 lg:px-8" id="homeowners">
    <div class="text-center max-w-3xl mx-auto mb-10">
      <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white border border-slate-200 shadow-sm mb-6">
        <span class="relative flex h-2 w-2">
          <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"></span>
          <span class="relative inline-flex rounded-full h-2 w-2 bg-blue-500"></span>
        </span>
        <span class="text-xs font-bold text-slate-500 uppercase tracking-wide">AI-Powered Home Care</span>
      </div>
      <h1 class="text-5xl md:text-6xl font-extrabold text-slate-900 tracking-tight mb-4">
        Your home, <span class="text-blue-600">handled.</span>
      </h1>
      <p class="text-xl text-slate-500">
        Diagnose issues, get fair price estimates, and hire verified pros‚Äîall in one place.
      </p>
    </div>

    <!-- Photo Preview Strip -->
    <div id="photo-preview-container" class="photo-preview-container hidden"></div>

    <!-- Smart Composer -->
    <div class="smart-composer">
      <input
        type="text"
        id="ai-input"
        placeholder="Describe the issue (e.g., 'Cracked Foundation')..."
      />

      <div class="composer-divider"></div>

      <button
        onclick="document.getElementById('hidden-file-input').click()"
        class="composer-photo-btn"
        title="Add Photos (Max 5)"
        type="button"
      >
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
        </svg>
      </button>

      <button
        onclick="startAnalysis()"
        class="composer-submit-btn"
        type="button"
      >
        <span>Analyze</span>
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
        </svg>
      </button>
    </div>

    <input
      type="file"
      id="hidden-file-input"
      multiple
      accept="image/*"
      class="hidden"
      onchange="handlePhotoSelection(this)"
    />
  </div>

  <!-- AI RESULTS SECTION (Hidden by default, shown after analysis) -->
  <section id="ai-results-section" class="ai-results-section" style="display: none;">
    <div class="results-container">
      <div id="ai-results-content"></div>
    </div>
  </section>

  <!-- LOADING STATE -->
  <div id="loading-overlay" class="loading-overlay" style="display: none;">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p class="loading-text">Analyzing your issue...</p>
      <p class="loading-subtext">This may take 15-30 seconds</p>
    </div>
  </div>

  <!-- ACTION GRID (Bento Layout) -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 -mt-8 mb-24 relative z-10">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">

      <!-- Post a Project - Hero Card (2 columns) -->
      <a href="/post-project.html" class="col-span-1 md:col-span-2 bg-white rounded-3xl p-8 shadow-sm border border-blue-100 hover:shadow-lg hover:border-blue-200 transition-all group relative overflow-hidden flex flex-col md:flex-row items-start md:items-center gap-6">

        <!-- Soft blue glow background -->
        <div class="absolute top-0 right-0 w-64 h-64 bg-blue-50 rounded-full blur-3xl -mr-16 -mt-16 opacity-50 pointer-events-none"></div>

        <!-- Icon Box -->
        <div class="relative z-10 p-4 bg-blue-50 text-blue-600 rounded-2xl group-hover:scale-110 transition-transform flex-shrink-0">
          <i class="fa-solid fa-clipboard-check text-3xl"></i>
        </div>

        <!-- Text Content -->
        <div class="relative z-10 flex-1">
          <h3 class="text-2xl font-bold text-slate-900 mb-2">Ready to hire?</h3>
          <p class="text-slate-500 text-lg">Post your project to get bids from verified pros. We handle the vetting.</p>
        </div>

        <!-- CTA Button -->
        <div class="relative z-10 mt-4 md:mt-0 flex-shrink-0">
          <div class="inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white font-bold rounded-xl shadow-md shadow-blue-500/20 group-hover:bg-blue-700 transition-all group-hover:gap-3">
            <span>Post Project</span>
            <i class="fa-solid fa-arrow-right"></i>
          </div>
        </div>

      </a>

      <!-- Price Estimator -->
      <a href="/pricing-estimator.html" class="bg-white rounded-3xl p-8 shadow-sm border border-slate-100 hover:shadow-lg hover:-translate-y-1 transition-all group">
        <div class="p-3 bg-emerald-50 text-emerald-600 rounded-xl w-fit mb-4 group-hover:scale-110 transition-transform">
          <i class="fa-solid fa-calculator text-2xl"></i>
        </div>
        <h3 class="text-2xl font-bold text-slate-900 mb-2">Price Estimator</h3>
        <p class="text-slate-500 mb-6">Don't guess. Get a fair market cost range for your zip code instantly.</p>
        <span class="text-blue-600 font-semibold flex items-center gap-2 group-hover:gap-3 transition-all">
          Calculate Cost <i class="fa-solid fa-arrow-right"></i>
        </span>
      </a>

      <!-- Find a Pro -->
      <a href="/browse-contractors.html" class="bg-white rounded-3xl p-8 shadow-sm border border-slate-100 hover:shadow-lg hover:-translate-y-1 transition-all group">
        <div class="p-3 bg-purple-50 text-purple-600 rounded-xl w-fit mb-4 group-hover:scale-110 transition-transform">
          <i class="fa-solid fa-magnifying-glass text-2xl"></i>
        </div>
        <h3 class="text-2xl font-bold text-slate-900 mb-2">Find a Pro</h3>
        <p class="text-slate-500 mb-6">Browse our directory of graded, licensed, and insured contractors.</p>
        <span class="text-blue-600 font-semibold flex items-center gap-2 group-hover:gap-3 transition-all">
          Search Directory <i class="fa-solid fa-arrow-right"></i>
        </span>
      </a>

      <!-- HomeProHub Grade Banner (2 columns) -->
      <div class="col-span-1 md:col-span-2 bg-gradient-to-br from-blue-50 to-white rounded-3xl p-8 shadow-sm border border-blue-100 flex items-center justify-between">
        <div>
          <h3 class="text-xl font-bold text-slate-900 mb-1">The HomeProHub Grade‚Ñ¢</h3>
          <p class="text-slate-500">We grade every contractor on Licenses, Insurance, and Reviews. If they aren't an A or B, they aren't here.</p>
        </div>
        <div class="hidden md:block text-5xl font-black text-blue-200">
          A+
        </div>
      </div>
    </div>
  </div>

  <!-- SECTION C: HOW IT WORKS -->
  <section class="how-it-works" id="how-it-works">
    <div class="section-container">
      <h2 class="section-title">How It Works</h2>

      <div class="steps-grid">
        <div class="step-card">
          <div class="step-number">1</div>
          <h3 class="step-title">Free AI Clarity</h3>
          <p class="step-description">
            Upload a photo or describe your issue. Get plain-English guidance on what might be happening.
          </p>
        </div>

        <div class="step-card">
          <div class="step-number">2</div>
          <h3 class="step-title">Understand Your Options</h3>
          <p class="step-description">
            Get safety guidance, urgency assessment, and "what to tell a contractor" summaries ‚Äî all free.
          </p>
        </div>

        <div class="step-card">
          <div class="step-number">3</div>
          <h3 class="step-title">Connect When Ready</h3>
          <p class="step-description">
            Post your job and connect with vetted, licensed contractors. Free to post. No obligation.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- SECTION D: THREE-PATH EXPLAINER -->
  <section class="three-paths">
    <div class="section-container">
      <h2 class="section-title">Three Paths Forward</h2>
      <p style="text-align: center; color: #6b7280; max-width: 700px; margin: 0 auto 0; font-size: 16px;">
        After your AI analysis, you choose what happens next. No pressure, no funnel.
      </p>

      <div class="paths-grid">
        <!-- PATH 1: UNDERSTAND (No button) -->
        <div class="path-card no-button">
          <span class="path-icon">üîç</span>
          <h3 class="path-title">Understand</h3>
          <p class="path-subtitle">
            Review the AI diagnosis, safety warnings, and what to tell a contractor.
          </p>

          <div class="path-features">
            <div class="path-feature">
              <span>‚úì</span>
              <span>Educational guidance</span>
            </div>
            <div class="path-feature">
              <span>‚úì</span>
              <span>Safety & urgency assessment</span>
            </div>
            <div class="path-feature">
              <span>‚úì</span>
              <span>DIY context when relevant</span>
            </div>
            <div class="path-feature">
              <span>‚úì</span>
              <span>Completely free</span>
            </div>
          </div>

          <p class="path-note">This is your thinking space. No buttons, no pressure.</p>
        </div>

        <!-- PATH 2: HIRE A PRO (Free) -->
        <div class="path-card">
          <span class="path-icon">üèóÔ∏è</span>
          <h3 class="path-title">Hire a Pro</h3>
          <p class="path-subtitle">
            Connect with vetted, licensed contractors. Graded on performance, not ads.
          </p>

          <div class="path-features">
            <div class="path-feature">
              <span>‚úì</span>
              <span>Free to post your job</span>
            </div>
            <div class="path-feature">
              <span>‚úì</span>
              <span>No obligation to hire</span>
            </div>
            <div class="path-feature">
              <span>‚úì</span>
              <span>You choose who to contact</span>
            </div>
            <div class="path-feature">
              <span>‚úì</span>
              <span>Licensed & background-checked</span>
            </div>
          </div>

          <button class="btn-primary" onclick="redirectToDirectory()">Browse Verified Contractors</button>
        </div>

        <!-- PATH 3: ASK AN EXPERT (Paid) -->
        <div class="path-card">
          <span class="path-icon">üë®‚Äçüîß</span>
          <h3 class="path-title">Ask an Expert</h3>
          <p class="path-subtitle">
            Want a straight answer right now? On-demand video or phone consultation.
          </p>

          <div class="path-features">
            <div class="path-feature">
              <span>üìû</span>
              <span>Live expert by phone/video</span>
            </div>
            <div class="path-feature">
              <span>‚è±Ô∏è</span>
              <span>15-30 minute sessions</span>
            </div>
            <div class="path-feature">
              <span>üéì</span>
              <span>Licensed professionals with 10+ years</span>
            </div>
            <div class="path-feature">
              <span>üìù</span>
              <span>Written summary provided</span>
            </div>
          </div>

          <button class="btn-primary" onclick="showExpertAccess()">Talk to an Expert (Paid)</button>
          <p class="path-note">Optional paid service. Pricing shown before confirmation.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- SECTION E: FAQ -->
  <section class="faq" id="faq">
    <div class="faq-container">
      <h2 class="section-title">Frequently Asked Questions</h2>

      <div class="faq-item">
        <div class="faq-question">Is HomeProHub free for homeowners?</div>
        <div class="faq-answer">
          Yes. AI exploration, job posting, and contractor connection are completely free.
          The only paid option is on-demand expert access ($50/session), which is entirely optional.
        </div>
      </div>

      <div class="faq-item">
        <div class="faq-question">What's paid, and when?</div>
        <div class="faq-answer">
          Homeowners only pay for on-demand expert access (video/phone consultations).
          Everything else is free. Contractors pay for access to homeowner job leads.
          Pricing is shown clearly before you confirm any paid service.
        </div>
      </div>

      <div class="faq-item">
        <div class="faq-question">What does "free to connect" mean?</div>
        <div class="faq-answer">
          You can post jobs, browse contractors, and receive bids without paying anything.
          There's no obligation to hire anyone. You control the entire process.
        </div>
      </div>

      <div class="faq-item">
        <div class="faq-question">How are contractors vetted and licensed?</div>
        <div class="faq-answer">
          All contractors are verified for active licenses, insurance, and background checks.
          They're graded A‚ÄìF based on performance, licensing, education, and homeowner feedback
          ‚Äî not paid placement or advertising.
        </div>
      </div>

      <div class="faq-item">
        <div class="faq-question">How do homeowner grades work?</div>
        <div class="faq-answer">
          Homeowners are graded on communication, project preparedness, and follow-through.
          This helps contractors identify serious, respectful clients and reduces wasted visits.
        </div>
      </div>

      <div class="faq-item">
        <div class="faq-question">Is AI diagnosis guaranteed?</div>
        <div class="faq-answer">
          No. Our AI provides educational guidance to help you understand your issue,
          but it does not replace an in-person inspection by a licensed professional.
          Always consult a qualified contractor for accurate diagnosis and repair.
        </div>
      </div>

      <div class="faq-item">
        <div class="faq-question">Do I have to hire through HomeProHub?</div>
        <div class="faq-answer">
          No. You can use our free AI analysis and never hire anyone. You can also
          browse contractors just to compare, or take our AI insights to any contractor you choose.
          There's no lock-in.
        </div>
      </div>
    </div>
  </section>

  <!-- SECTION H: FOOTER -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-grid">
        <div>
          <div class="footer-brand">HomeProHub</div>
          <p class="footer-disclaimer">
            AI guidance provided by HomeProHub is educational and does not constitute
            professional inspection, diagnosis, or repair advice. Always consult licensed
            professionals for accurate assessment and work.
          </p>
        </div>

        <div>
          <div class="footer-section-title">Product</div>
          <ul class="footer-links">
            <li><a href="#homeowners">For Homeowners</a></li>
            <li><a href="#contractors">For Contractors</a></li>
            <li><a href="#how-it-works">How It Works</a></li>
            <li><a href="#pricing">Pricing</a></li>
          </ul>
        </div>

        <div>
          <div class="footer-section-title">Company</div>
          <ul class="footer-links">
            <li><a href="#">About Us</a></li>
            <li><a href="#">Contact</a></li>
            <li><a href="#faq">FAQ</a></li>
          </ul>
        </div>

        <div>
          <div class="footer-section-title">Legal</div>
          <ul class="footer-links">
            <li><a href="#">Terms of Service</a></li>
            <li><a href="#">Privacy Policy</a></li>
            <li><a href="#">Contractor Agreement</a></li>
          </ul>
        </div>
      </div>

      <div class="footer-bottom">
        ¬© 2025 HomeProHub. Trust is the feature.
      </div>
    </div>
  </footer>

  <!-- Role Selection Modal -->
  <div class="modal" id="roleModal">
    <div class="modal-content">
      <h2 class="modal-title">I am a...</h2>

      <div class="role-options">
        <div class="role-option" onclick="selectRole('homeowner')">
          <div class="role-option-title">üè† Homeowner</div>
          <div class="role-option-description">
            Free AI guidance, free contractor connection
          </div>
        </div>

        <div class="role-option" onclick="selectRole('contractor')">
          <div class="role-option-title">üîß Contractor</div>
          <div class="role-option-description">
            Access quality leads, get graded on performance
          </div>
        </div>
      </div>

      <div class="modal-close">
        <button onclick="closeModal()">Cancel</button>
      </div>
    </div>
  </div>

  <script>
    // Role selection modal
    function showRoleSelection(defaultRole) {
      if (defaultRole) {
        selectRole(defaultRole);
      } else {
        document.getElementById('roleModal').classList.add('active');
      }
    }

    function closeModal() {
      document.getElementById('roleModal').classList.remove('active');
    }

    async function selectRole(role) {
      closeModal();

      // Check if user is already signed in
      if (window.authService && window.authService.initialized) {
        const user = await window.authService.getCurrentUser();
        if (user) {
          // User is signed in, redirect based on role
          if (role === 'homeowner') {
            window.location.href = 'home.html';
          } else {
            window.location.href = 'contractor.html';
          }
          return;
        }
      }

      // Not signed in, redirect to sign up with role
      sessionStorage.setItem('signup_role', role);
      window.location.href = 'signup.html';
    }

    function showSignIn() {
      window.location.href = 'signin.html';
    }

    // ========================================
    // Smart Composer Logic
    // ========================================

    const MAX_PHOTOS = 5;
    let selectedFiles = [];

    function handlePhotoSelection(input) {
      const files = Array.from(input.files);

      // Validate count
      if (selectedFiles.length + files.length > MAX_PHOTOS) {
        alert(`You can only upload up to ${MAX_PHOTOS} photos.`);
        input.value = ''; // Reset input
        return;
      }

      // Add new files
      selectedFiles = [...selectedFiles, ...files];
      updatePreviewUI();

      // Reset file input so same file can be selected again
      input.value = '';
    }

    function updatePreviewUI() {
      const container = document.getElementById('photo-preview-container');
      container.innerHTML = ''; // Clear current previews

      if (selectedFiles.length > 0) {
        container.classList.remove('hidden');
      } else {
        container.classList.add('hidden');
        return;
      }

      selectedFiles.forEach((file, index) => {
        const reader = new FileReader();
        reader.onload = (e) => {
          // Create thumbnail card
          const div = document.createElement('div');
          div.className = 'photo-preview-item';
          div.innerHTML = `
            <img src="${e.target.result}" alt="Preview ${index + 1}">
            <button
              onclick="removePhoto(${index})"
              class="photo-remove-btn"
              type="button"
              aria-label="Remove photo"
            >
              <svg style="width: 12px; height: 12px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          `;
          container.appendChild(div);
        };
        reader.readAsDataURL(file);
      });
    }

    function removePhoto(index) {
      selectedFiles.splice(index, 1);
      updatePreviewUI();
    }

    async function startAnalysis() {
      const input = document.getElementById('ai-input');
      const description = input.value.trim();

      // Validate: need at least description OR photos
      if (!description && selectedFiles.length === 0) {
        alert('Please provide either a description or upload at least one photo');
        return;
      }

      // Show loading overlay
      document.getElementById('loading-overlay').style.display = 'flex';

      try {
        // Convert photos to base64
        const images = [];
        for (const file of selectedFiles) {
          const base64 = await fileToBase64(file);
          images.push({
            data: base64.split(',')[1], // Remove data URL prefix
            type: file.type
          });
        }

        // Call AI Check API (NO AUTH REQUIRED!)
        const response = await fetch('/api/ai-check', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            description: description || undefined,
            images: images.length > 0 ? images : undefined
          })
        });

        if (!response.ok) {
          const error = await response.json();
          throw new Error(error.error || 'Analysis failed');
        }

        const result = await response.json();

        // Store result in sessionStorage (for "Save Report" feature)
        sessionStorage.setItem('ai_check_result', JSON.stringify({
          description,
          output: result.output,
          timestamp: new Date().toISOString()
        }));

        // Render results inline
        renderResults(result.output, description);

        // Hide loading, show results
        document.getElementById('loading-overlay').style.display = 'none';
        document.getElementById('ai-results-section').style.display = 'block';

        // Scroll to results
        document.getElementById('ai-results-section').scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });

      } catch (error) {
        console.error('AI Check error:', error);
        document.getElementById('loading-overlay').style.display = 'none';
        alert(`Analysis failed: ${error.message}. Please try again.`);
      }
    }

    function fileToBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    }

    /**
     * Render AI Check Results
     * Displays comprehensive, structured diagnosis inline
     */
    function renderResults(output, description) {
      const container = document.getElementById('ai-results-content');
      if (!container) return;

      // Build HTML for results
      let html = '';

      // Header with badges
      html += '<div class="result-header">';
      html += `<h2>${output.summary}</h2>`;
      html += '<div class="result-badges">';

      // Confidence badge
      const confidenceColors = {
        high: 'var(--success)',
        medium: 'var(--warning)',
        low: 'var(--error)'
      };
      html += `<span class="confidence-badge" style="background: ${confidenceColors[output.confidence]}20; color: ${confidenceColors[output.confidence]}">
        ${output.confidence.toUpperCase()} CONFIDENCE
      </span>`;

      // DIY level badge
      const diyLabels = {
        safe_to_diy: 'SAFE TO DIY',
        inspection_only: 'INSPECTION ONLY',
        pro_recommended: 'PRO RECOMMENDED',
        urgent: 'URGENT - GET HELP NOW'
      };
      const diyColors = {
        safe_to_diy: 'var(--success)',
        inspection_only: 'var(--info)',
        pro_recommended: 'var(--warning)',
        urgent: 'var(--error)'
      };
      html += `<span class="diy-badge" style="background: ${diyColors[output.diy_level]}; color: white">
        ${diyLabels[output.diy_level]}
      </span>`;

      html += '</div>'; // result-badges
      html += '</div>'; // result-header

      // Safety Flags (if any)
      if (output.safety_flags && output.safety_flags.length > 0) {
        html += '<div class="safety-flags">';
        output.safety_flags.forEach(flag => {
          html += `<div class="safety-flag">‚ö†Ô∏è ${flag}</div>`;
        });
        html += '</div>';
      }

      // Likely Causes
      html += '<div class="result-section">';
      html += '<h3>Most Likely Causes</h3>';
      html += '<div class="causes-grid">';

      const likelihoodLabels = {
        most_likely: 'MOST LIKELY',
        possible: 'POSSIBLE',
        less_likely: 'LESS LIKELY'
      };
      const likelihoodColors = {
        most_likely: 'var(--error)',
        possible: 'var(--warning)',
        less_likely: 'var(--info)'
      };

      output.likely_causes.forEach(cause => {
        html += '<div class="cause-card">';
        html += `<div class="cause-header">
          <h4>${cause.label}</h4>
          <span class="likelihood-badge" style="background: ${likelihoodColors[cause.likelihood]}; color: white">
            ${likelihoodLabels[cause.likelihood]}
          </span>
        </div>`;
        html += `<p>${cause.why}</p>`;
        html += '</div>';
      });

      html += '</div>'; // causes-grid
      html += '</div>'; // result-section

      // Do Now / Don't Do (side by side on desktop)
      html += '<div class="actions-grid">';

      // Do Now
      html += '<div class="result-section">';
      html += '<h3>‚úÖ Do Now</h3>';
      html += '<ul class="action-list do-list">';
      output.do_now.forEach(action => {
        html += `<li>${action}</li>`;
      });
      html += '</ul>';
      html += '</div>';

      // Don't Do
      html += '<div class="result-section">';
      html += '<h3>‚õî Don\'t Do</h3>';
      html += '<ul class="action-list dont-list">';
      output.dont_do.forEach(action => {
        html += `<li>${action}</li>`;
      });
      html += '</ul>';
      html += '</div>';

      html += '</div>'; // actions-grid

      // Who to Call
      html += '<div class="result-section">';
      html += '<h3>Who to Call</h3>';
      html += '<div class="trade-card">';
      html += `<div class="trade-name">${output.who_to_call.trade.replace(/_/g, ' ').toUpperCase()}</div>`;
      html += `<div class="trade-why">${output.who_to_call.why}</div>`;
      html += '</div>';
      html += '</div>';

      // Cost Estimate
      html += '<div class="result-section">';
      html += '<h3>Cost Estimate</h3>';
      html += '<div class="cost-card">';

      const costLabels = {
        low: 'LOW (Under $500)',
        medium: 'MEDIUM ($500 - $5,000)',
        high: 'HIGH (Over $5,000)',
        unknown: 'UNKNOWN (Needs Inspection)'
      };
      html += `<div class="cost-tier">${costLabels[output.cost_tier.tier]}</div>`;
      html += '<div class="cost-drivers">';
      html += '<strong>Cost Factors:</strong>';
      html += '<ul>';
      output.cost_tier.drivers.forEach(driver => {
        html += `<li>${driver}</li>`;
      });
      html += '</ul>';
      html += '</div>';
      html += '</div>';
      html += '</div>';

      // Follow-up Question (if any)
      if (output.one_question) {
        html += '<div class="result-section">';
        html += '<div class="follow-up-question">';
        html += `<strong>Follow-up:</strong> ${output.one_question}`;
        html += '</div>';
        html += '</div>';
      }

      // Pro Message (copy/paste ready)
      html += '<div class="result-section">';
      html += '<h3>Message for Contractors</h3>';
      html += '<div class="pro-message-box">';
      html += `<p>${output.pro_message}</p>`;
      html += '<button class="copy-btn" onclick="copyProMessage()">üìã Copy Message</button>';
      html += '</div>';
      html += '</div>';

      // CTA Buttons
      html += '<div class="result-section">';
      html += '<div class="cta-buttons">';

      // Primary CTA
      html += `<button class="cta-primary" onclick="handleCTA('${output.cta.primary.action}')">
        ${output.cta.primary.label}
      </button>`;

      // Secondary CTA (if present)
      if (output.cta.secondary) {
        html += `<button class="cta-secondary" onclick="handleCTA('${output.cta.secondary.action}')">
          ${output.cta.secondary.label}
        </button>`;
      }

      html += '</div>';
      html += '</div>';

      // Start Over Button
      html += '<div class="result-section">';
      html += '<button class="start-over-btn" onclick="startOver()">‚Üª Start New Analysis</button>';
      html += '</div>';

      // Insert HTML
      container.innerHTML = html;
    }

    /**
     * Copy pro message to clipboard
     */
    function copyProMessage() {
      const result = JSON.parse(sessionStorage.getItem('ai_check_result') || '{}');
      if (result.output && result.output.pro_message) {
        navigator.clipboard.writeText(result.output.pro_message).then(() => {
          const btn = event.target;
          const originalText = btn.textContent;
          btn.textContent = '‚úì Copied!';
          btn.style.background = 'var(--success)';
          setTimeout(() => {
            btn.textContent = originalText;
            btn.style.background = '';
          }, 2000);
        }).catch(err => {
          alert('Failed to copy. Please select and copy manually.');
        });
      }
    }

    /**
     * Handle CTA button clicks
     */
    function handleCTA(action) {
      switch(action) {
        case 'browse_contractors':
          window.location.href = 'contractor-directory.html';
          break;
        case 'get_matched':
          window.location.href = 'contractor-matching.html';
          break;
        case 'request_quote':
          window.location.href = 'request-quote.html';
          break;
        case 'save_report':
          // Check if user is logged in
          fetch('/api/auth/user', { credentials: 'include' })
            .then(res => res.json())
            .then(data => {
              if (data.user) {
                // User is logged in, save the report
                saveReport();
              } else {
                // Redirect to login with return URL
                sessionStorage.setItem('return_after_login', window.location.pathname);
                window.location.href = 'login.html?reason=save_report';
              }
            })
            .catch(() => {
              // Assume not logged in
              sessionStorage.setItem('return_after_login', window.location.pathname);
              window.location.href = 'login.html?reason=save_report';
            });
          break;
        default:
          console.log('Unknown CTA action:', action);
      }
    }

    /**
     * Save report (authenticated users only)
     */
    function saveReport() {
      const result = JSON.parse(sessionStorage.getItem('ai_check_result') || '{}');

      fetch('/api/ai-check/save', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        credentials: 'include',
        body: JSON.stringify(result)
      })
      .then(res => res.json())
      .then(data => {
        alert('Report saved! You can view it in your dashboard.');
        window.location.href = 'homeowner-dashboard.html';
      })
      .catch(err => {
        alert('Failed to save report. Please try again.');
      });
    }

    /**
     * Start over - reset the form
     */
    function startOver() {
      // Hide results
      document.getElementById('ai-results-section').style.display = 'none';

      // Clear form
      document.getElementById('ai-input').value = '';
      selectedFiles = [];
      updatePhotoPreview();

      // Clear sessionStorage
      sessionStorage.removeItem('ai_check_result');

      // Scroll back to top
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function redirectToDirectory() {
      window.location.href = 'contractor-directory.html';
    }

    function showExpertAccess() {
      window.location.href = 'expert-booking.html';
    }

    // Smooth scroll for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        const href = this.getAttribute('href');
        if (href !== '#' && href.length > 1) {
          e.preventDefault();
          const target = document.querySelector(href);
          if (target) {
            target.scrollIntoView({ behavior: 'smooth' });
          }
        }
      });
    });

    // ========================================
    // Account Deletion Goodbye Toast
    // ========================================

    function showToast() {
      const toast = document.getElementById('accountDeletedToast');
      if (toast) {
        // Show toast with animation
        setTimeout(() => {
          toast.classList.add('show');
        }, 300);

        // Auto-hide after 6 seconds
        setTimeout(() => {
          closeToast();
        }, 6000);
      }
    }

    function closeToast() {
      const toast = document.getElementById('accountDeletedToast');
      if (toast) {
        toast.classList.remove('show');
      }
    }

    // Check for account deletion flag on page load
    (function() {
      if (sessionStorage.getItem('account_deleted') === 'true') {
        // Clear the flag
        sessionStorage.removeItem('account_deleted');
        // Show goodbye message
        showToast();
      }
    })();
  </script>
</body>
</html>
