<!DOCTYPE html>
<html>
<head>
  <title>HomeProHub â€“ Profile Setup</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="form-container">
    <h1>Complete Your Profile</h1>
    <form id="profileForm">
      <label for="userRole">Role:</label>
      <select id="userRole" required>
        <option value="contractor">Contractor</option>
        <option value="homeowner">Homeowner</option>
      </select>
      <label for="companyName">Company Name:</label>
      <input id="companyName" type="text" required />
      <button type="submit">Save</button>
    </form>
  </div>

<script>
    const username = localStorage.getItem("username");
    if (!username) window.location.href = "index.html";

    document.addEventListener("DOMContentLoaded", async () => {
        try {
            const profileData = localStorage.getItem("contractorProfile");
            if (profileData) {
                const profile = JSON.parse(profileData);
                document.getElementById("userRole").value = profile.role || "contractor";
                document.getElementById("companyName").value = profile.companyName || "";
            }
        } catch (err) {
            console.error("Error loading profile data:", err);
        }
    });

    document.getElementById("profileForm").addEventListener("submit", (e) => {
        e.preventDefault();
        const role = document.getElementById("userRole").value;
        const companyName = document.getElementById("companyName").value;

        const profile = { role, companyName, profileComplete: true };
        localStorage.setItem("contractorProfile", JSON.stringify(profile));
        window.location.href = "dashboard.html";
    });
</script>
</body>
</html>